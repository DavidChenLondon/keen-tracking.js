{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./node_modules/keen-core/lib/utils/each.js","webpack:///./node_modules/keen-core/lib/utils/extend.js","webpack:///./lib/index.js","webpack:///./lib/utils/deepExtend.js","webpack:///./lib/extend-events.js","webpack:///./lib/config-default.js","webpack:///./lib/utils/queue.js","webpack:///./lib/utils/timer.js","webpack:///./lib/helpers/getUniqueId.js","webpack:///./lib/helpers/getDatetimeIndex.js","webpack:///./lib/defer-events.js","webpack:///external \"https\"","webpack:///external \"http\"","webpack:///./lib/utils/nodeRequestRetry.js","webpack:///./lib/record-events-server.js","webpack:///external \"component-emitter\"","webpack:///external \"keen-core\"","webpack:///./lib/server.js"],"names":["KeenCore","helpers","on","client","extensions","events","collections","queue","config","recordDeferredEvents","prototype","writeKey","str","arguments","length","String","referrerPolicy","setGlobalProperties","props","log","emit","globalProperties","deepExtend","target","i","Array","j","indexOf","push","prop","clone","undefined","input","JSON","parse","stringify","extendEvent","extendEvents","getExtendedEventBody","eventCollection","eventModifier","handleValidationError","call","eventsModifier","message","err","result","modifierResult","configDefault","capacity","interval","retry","limit","initialDelay","retryOnResponseStatuses","configQueue","timer","check","shouldFlushQueue","flush","pause","clearInterval","start","self","setInterval","num","count","value","clear","getUniqueId","crypto","getRandomValues","replace","c","Uint8Array","toString","r","Math","random","v","getDatetimeIndex","date","Date","getHours","parseInt","getDay","getDate","getMonth","getFullYear","deferEvent","deferEvents","queueCapacity","queueInterval","eventBody","eventsHash","eventList","concat","Number","clonedQueueConfig","clonedQueueEvents","recordEvents","res","options","retriesLimit","retryDelay","retryOn","retriesCount","name","protocol","http","https","wrappedRequest","n","req","request","response","body","d","statusCode","callbackOnSuccess","callbackOnError","write","data","end","setTimeout","recordEvent","addEvent","addEvents","callback","url","cb","extendedEventBody","checkValidation","Keen","enabled","sendEventData","encodeURIComponent","extendedEventsHash","collection","index","modified","apply","projectId","path","eventData","urlPath","host","method","headers","Buffer","byteLength","nodeRequestConfig","responseBody","error","e","error_code","Error","code","utils","version","pkg","module","exports"],"mappings":"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","file":"node/keen-tracking.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"component-emitter\"), require(\"keen-core\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"component-emitter\", \"keen-core\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"component-emitter\"), require(\"keen-core\")) : factory(root[\"component-emitter\"], root[\"keen-core\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(global, function(__WEBPACK_EXTERNAL_MODULE__16__, __WEBPACK_EXTERNAL_MODULE__17__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 18);\n","module.exports = each;\n\nfunction each(o, cb, s){\n  var n;\n  if (!o){\n    return 0;\n  }\n  s = !s ? o : s;\n  if (o instanceof Array){\n    // Indexed arrays, needed for Safari\n    for (n=0; n<o.length; n++) {\n      if (cb.call(s, o[n], n, o) === false){\n        return 0;\n      }\n    }\n  } else {\n    // Hashtables\n    for (n in o){\n      if (o.hasOwnProperty(n)) {\n        if (cb.call(s, o[n], n, o) === false){\n          return 0;\n        }\n      }\n    }\n  }\n  return 1;\n}\n","module.exports = extend;\n\nfunction extend(target){\n  for (var i = 1; i < arguments.length; i++) {\n    for (var prop in arguments[i]){\n      target[prop] = arguments[i][prop];\n    }\n  }\n  return target;\n};\n","import KeenCore from 'keen-core';\nimport each from 'keen-core/lib/utils/each';\nimport extend from 'keen-core/lib/utils/extend';\nimport { queue } from'./utils/queue';\n\nKeenCore.helpers = KeenCore.helpers || {};\n\n// Install internal queue\nKeenCore.on('client', function(client){\n  client.extensions = {\n    events: [],\n    collections: {}\n  };\n  client.queue = queue(client.config.queue);\n  client.queue.on('flush', function(){\n    client.recordDeferredEvents();\n  });\n});\n\n// Accessors\nKeenCore.prototype.writeKey = function(str){\n  if (!arguments.length) return this.config.writeKey;\n  this.config.writeKey = (str ? String(str) : null);\n  return this;\n};\n\nKeenCore.prototype.referrerPolicy = function(str){\n  if (!arguments.length) return this.config.referrerPolicy;\n  this.config.referrerPolicy = (str ? String(str) : null);\n  return this;\n};\n\n// DEPRECATED\nKeenCore.prototype.setGlobalProperties = function(props){\n  KeenCore.log('This method has been deprecated. Check out #extendEvents: https://github.com/keen/keen-tracking.js#extend-events');\n  if (!props || typeof props !== 'function') {\n    this.emit('error', 'Invalid value for global properties: ' + props);\n    return;\n  }\n  this.config.globalProperties = props;\n  return this;\n};\n\nexport default KeenCore;\n","export const deepExtend = function(target){\n  for (var i = 1; i < arguments.length; i++) {\n    // Copy unique items from incoming array\n    if (target instanceof Array && arguments[i] instanceof Array) {\n      for (var j = 0; j < arguments[i].length; j++) {\n        if (target.indexOf(arguments[i][j]) < 0) {\n          target.push(arguments[i][j]);\n        }\n      }\n    }\n    // Blend objects\n    else {\n      for (var prop in arguments[i]){\n        // Recurse when both contain objects of same name\n        // and incoming is not a null object\n        if (typeof target[prop] !== 'undefined'\n          && typeof arguments[i][prop] === 'object'\n          && arguments[i][prop] !== null) {\n            deepExtend(target[prop], clone(arguments[i][prop]));\n        }\n        // Otherwise just copy it over...\n        else if (\n          arguments[i][prop] !== undefined &&\n          typeof arguments[i][prop] !== 'function') {\n            target[prop] = clone(arguments[i][prop]);\n        }\n      }\n    }\n  }\n  return target;\n}\n\nfunction clone(input){\n  return JSON.parse( JSON.stringify(input) );\n}\n","import { deepExtend } from './utils/deepExtend';\nimport each from 'keen-core/lib/utils/each';\n\nexport function extendEvent(eventCollection, eventModifier){\n  if (arguments.length !== 2 || typeof eventCollection !== 'string'\n    || ('object' !== typeof eventModifier && 'function' !== typeof eventModifier)) {\n      handleValidationError.call(this, 'Incorrect arguments provided to #extendEvent method');\n      return;\n  }\n  this.extensions.collections[eventCollection] = this.extensions.collections[eventCollection] || [];\n  this.extensions.collections[eventCollection].push(eventModifier);\n  this.emit('extendEvent', eventCollection, eventModifier);\n  return this;\n}\n\nexport function extendEvents(eventsModifier){\n  if (arguments.length !== 1 || ('object' !== typeof eventsModifier && 'function' !== typeof eventsModifier)) {\n    handleValidationError.call(this, 'Incorrect arguments provided to #extendEvents method');\n    return;\n  }\n  this.extensions.events.push(eventsModifier);\n  this.emit('extendEvents', eventsModifier);\n  return this;\n}\n\nfunction handleValidationError(message){\n  var err = 'Event(s) not extended: ' + message;\n  this.emit('error', err);\n}\n\nexport function getExtendedEventBody(result, queue){\n  if (queue && queue.length > 0) {\n    each(queue, function(eventModifier, i){\n      var modifierResult = (typeof eventModifier === 'function') ? eventModifier() : eventModifier;\n      deepExtend(result, modifierResult);\n    });\n  }\n  return result;\n}\n","export const configDefault = {\n\n  // defer events - queue\n  // https://github.com/keen/keen-tracking.js/blob/master/docs/defer-events.md\n  queue: {\n    capacity: 5000,\n    interval: 15\n  },\n\n  // connection problems - retry request\n  retry: {\n    limit: 10,\n    initialDelay: 200,\n    retryOnResponseStatuses: [\n      408,\n      500,\n      502,\n      503,\n      504\n    ]\n  }\n}\n\nexport default configDefault;\n","import Emitter from 'component-emitter';\n\nimport configDefault from '../config-default.js';\n\nexport function queue(configQueue = {}) {\n  if (this instanceof queue === false) {\n    return new queue(configQueue);\n  }\n  this.capacity = 0;\n  this.config = {\n    ...configDefault.queue,\n    ...configQueue\n  };\n  this.events = {\n    // \"collection-1\": [],\n    // \"collection-2\": []\n  };\n  this.interval = 0;\n  this.timer = null;\n  return this;\n}\n\nEmitter(queue.prototype);\n\nqueue.prototype.check = function() {\n  if (shouldFlushQueue(this)) {\n    this.flush();\n  }\n  if (this.config.interval === 0 || this.capacity === 0) {\n    this.pause();\n  }\n  return this;\n};\n\nqueue.prototype.flush = function() {\n  this.emit('flush');\n  this.interval = 0;\n  return this;\n};\n\nqueue.prototype.pause = function() {\n  if (this.timer) {\n    clearInterval(this.timer);\n    this.timer = null;\n  }\n  return this;\n};\n\nqueue.prototype.start = function() {\n  var self = this;\n  self.pause();\n  self.timer = setInterval(function() {\n    self.interval++;\n    self.check();\n  }, 1000);\n  return self;\n};\n\nfunction shouldFlushQueue(props) {\n  if (props.capacity > 0 && props.interval >= props.config.interval) {\n    return true;\n  }\n  else if (props.capacity >= props.config.capacity) {\n    return true;\n  }\n  return false;\n}\n","export function timer(num){\n  if (this instanceof timer === false) {\n    return new timer(num);\n  }\n  this.count = num || 0;\n  return this;\n}\n\ntimer.prototype.start = function(){\n  var self = this;\n  this.pause();\n  this.interval = setInterval(function(){\n    self.count++;\n  }, 1000);\n  return this;\n};\n\ntimer.prototype.pause = function(){\n  clearInterval(this.interval);\n  return this;\n};\n\ntimer.prototype.value = function(){\n  return this.count;\n};\n\ntimer.prototype.clear = function(){\n  this.count = 0;\n  return this;\n};\n","export function getUniqueId() {\n  // uuidv4\n  if (typeof crypto !== 'undefined' && crypto.getRandomValues) {\n    // browser\n    return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>\n      (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\n    )\n  } else {\n    // node & older browsers\n    let str = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx';\n    return str.replace(/[xy]/g, function(c) {\n      let r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);\n      return v.toString(16);\n    });\n  }\n}\n","export function getDatetimeIndex(input){\n  var date = input || new Date();\n  return {\n    'hour_of_day'  : date.getHours(),\n    'day_of_week'  : parseInt( 1 + date.getDay() ),\n    'day_of_month' : date.getDate(),\n    'month'        : parseInt( 1 + date.getMonth() ),\n    'year'         : date.getFullYear()\n  };\n}\n","import Keen from './index';\nimport each from 'keen-core/lib/utils/each';\nimport { queue } from './utils/queue';\n\nexport function deferEvent(eventCollection, eventBody){\n\n  if (arguments.length !== 2 || typeof eventCollection !== 'string') {\n    handleValidationError.call(this, 'Incorrect arguments provided to #deferEvent method');\n    return;\n  }\n\n  this.queue.events[eventCollection] = this.queue.events[eventCollection] || [];\n  this.queue.events[eventCollection].push(eventBody);\n  this.queue.capacity++;\n  if (!this.queue.timer) {\n    this.queue.start();\n  }\n  this.emit('deferEvent', eventCollection, eventBody);\n  return this;\n}\n\nexport function deferEvents(eventsHash){\n  var self = this;\n\n  if (arguments.length !== 1 || typeof eventsHash !== 'object') {\n    handleValidationError.call(this, 'Incorrect arguments provided to #deferEvents method');\n    return;\n  }\n\n  each(eventsHash, function(eventList, eventCollection){\n    self.queue.events[eventCollection] = self.queue.events[eventCollection] || [];\n    self.queue.events[eventCollection] = self.queue.events[eventCollection].concat(eventList);\n    self.queue.capacity = self.queue.capacity + eventList.length;\n    if (!self.queue.timer) {\n      self.queue.start();\n    }\n  });\n  self.emit('deferEvents', eventsHash);\n  return self;\n}\n\nexport function queueCapacity(num){\n  if (!arguments.length) return this.queue.config.capacity;\n  this.queue.config.capacity = num ? Number(num): 0;\n  this.queue.check();\n  return this;\n}\n\nexport function queueInterval(num){\n  if (!arguments.length) return this.queue.config.interval;\n  this.queue.config.interval = num ? Number(num): 0;\n  this.queue.check();\n  return this;\n}\n\nexport function recordDeferredEvents(){\n  const self = this;\n\n  if (self.queue.capacity > 0) {\n    self.queue.pause();\n    let clonedQueueConfig = { ...self.queue.config };\n    let clonedQueueEvents = { ...self.queue.events };\n    self.queue = queue();\n    self.queue.config = clonedQueueConfig;\n    self.queue.on('flush', function(){\n      self.recordDeferredEvents();\n    });\n    self.emit('recordDeferredEvents', clonedQueueEvents);\n    self.recordEvents(clonedQueueEvents, (err, res) => {\n      if (err) {\n        self.emit('recordDeferredEventsError', err, clonedQueueEvents);\n      }\n    });\n  }\n  return self;\n}\n\nfunction handleValidationError(message){\n  var err = 'Event(s) not deferred: ' + message;\n  this.emit('error', err);\n}\n","module.exports = require(\"https\");","module.exports = require(\"http\");","import http from 'http';\nimport https from 'https';\n\nimport configDefault from '../config-default.js';\n\nexport default function(options) {\n  const retriesLimit = (options.retry && options.retry.limit)\n    ? options.retry.limit : configDefault.retry.limit;\n  const retryDelay = (options.retry && options.retry.initialDelay)\n    ? options.retry.initialDelay : configDefault.retry.initialDelay;\n  const retryOn = (options.retry && options.retry.retryOnResponseStatuses)\n    ? options.retry.retryOnResponseStatuses : configDefault.retry.retryOnResponseStatuses;\n  let retriesCount = 0;\n\n  if (options && options.retryOn) {\n    if (!(options.retryOn instanceof Array)) {\n      throw {\n        name: 'ArgumentError',\n        message: 'retryOn property expects an array'\n      }\n    }\n  }\n\n  const protocol = (options.protocol === 'http') ? http : https;\n\n  const wrappedRequest = (n) => {\n    let req = protocol.request(options.config, (response) => {\n      let body = '';\n       response.on('data', (d)  => {\n         body += d;\n       });\n       response.on('end', ()  => {\n         if (retryOn.indexOf(response.statusCode) === -1) {\n           options.callbackOnSuccess(body);\n         } else {\n           if (n > 0) {\n             retry();\n           } else {\n             options.callbackOnError(body);\n           }\n         }\n       });\n    });\n    req.on('error', (err) => {\n      if (n > 0) {\n        retry();\n      } else {\n        options.callbackOnError(err);\n      }\n    });\n    req.write(options.data);\n    req.end();\n  }\n\n  function retry() {\n    retriesCount = retriesCount + 1;\n    setTimeout(function() {\n        wrappedRequest(retriesLimit - retriesCount);\n      }, 2^retriesCount * retryDelay);\n  }\n\n  wrappedRequest(retriesLimit - retriesCount);\n};\n","import Keen from './index';\nimport each from 'keen-core/lib/utils/each';\nimport extend from 'keen-core/lib/utils/extend';\nimport { getExtendedEventBody } from './extend-events';\n\nimport nodeRequestRetry from './utils/nodeRequestRetry';\n\n// ------------------------------\n// .recordEvent\n// ------------------------------\n\nexport function recordEvent(eventCollection, eventBody, callback){\n  var url, data, cb, extendedEventBody;\n\n  data = {};\n  cb = callback || function(){};\n  callback = null;\n\n  if (!checkValidation.call(this, cb)) {\n    return;\n  }\n\n  if (!eventCollection || typeof eventCollection !== 'string') {\n    handleValidationError.call(this, 'Collection name must be a string.', cb);\n    return;\n  }\n\n  // ------------------------------\n  // DEPRECATED\n  // Apply client.globalProperties\n  // ------------------------------\n  if (this.config.globalProperties) {\n    data = this.config.globalProperties(eventCollection);\n  }\n  extend(data, eventBody);\n\n  // ------------------------------\n  // Run extendEvent(s) transforms\n  // ------------------------------\n  extendedEventBody = {};\n  getExtendedEventBody(extendedEventBody, this.extensions.events);\n  getExtendedEventBody(extendedEventBody, this.extensions.collections[eventCollection]);\n  getExtendedEventBody(extendedEventBody, [data]);\n\n  this.emit('recordEvent', eventCollection, extendedEventBody);\n\n  if (!Keen.enabled) {\n    handleValidationError.call(this, 'Keen.enabled is set to false.', cb);\n    return false;\n  }\n\n  sendEventData.call(this, encodeURIComponent(eventCollection), extendedEventBody, cb);\n  cb = null;\n  return this;\n}\n\n\n\n// ------------------------------\n// .recordEvents\n// ------------------------------\n\nexport function recordEvents(eventsHash, callback){\n  var self = this, url, cb, extendedEventsHash;\n\n  cb = callback || function(){};\n  callback = null;\n\n  if (!checkValidation.call(this, cb)) {\n    return;\n  }\n\n  if (arguments.length > 2) {\n    handleValidationError.call(this, 'Incorrect arguments provided to #addEvents method', cb);\n    return;\n  }\n\n  // ------------------------------\n  // DEPRECATED\n  // Apply client.globalProperties\n  // ------------------------------\n  if (this.config.globalProperties) {\n    // Loop over each set of events\n    each(eventsHash, function(events, collection){\n      // Loop over each individual event\n      each(events, function(body, index){\n        // Start with global properties for this collection\n        var modified = self.config.globalProperties(collection);\n        // Apply provided properties for this event body\n        eventsHash[collection][index] = extend(modified, body);\n      });\n    });\n  }\n\n  // ------------------------------\n  // Run extendEvent(s) transforms\n  // ------------------------------\n  extendedEventsHash = {};\n  each(eventsHash, function(eventList, eventCollection){\n    // Find or create collection on new hash\n    extendedEventsHash[eventCollection] = extendedEventsHash[eventCollection] || [];\n    // Loop over each eventBody in the existing hash\n    each(eventList, function(eventBody, index){\n      // Create a new data object\n      var extendedEventBody = {};\n      // Process \"events\" transform pipeline\n      getExtendedEventBody(extendedEventBody, self.extensions.events);\n      // Process \"collection\" transform pipeline\n      getExtendedEventBody(extendedEventBody, self.extensions.collections[eventCollection]);\n      // Blend existing eventBody data into the result\n      getExtendedEventBody(extendedEventBody, [eventBody]);\n      // Push extendedEventBody into new hash\n      extendedEventsHash[eventCollection].push(extendedEventBody);\n    });\n  });\n\n  this.emit('recordEvents', extendedEventsHash);\n\n  if (!Keen.enabled) {\n    handleValidationError.call(this, 'Keen.enabled is set to false.', cb);\n    return false;\n  }\n\n  sendEventData.call(this, undefined, extendedEventsHash, cb);\n  cb = null;\n  return this;\n}\n\n\n// ----------------------\n// DEPRECATED\n// ----------------------\n\nexport function addEvent(){\n  this.emit('error', 'This method has been deprecated. Check out #recordEvent: https://github.com/keen/keen-tracking.js#record-a-single-event');\n  recordEvent.apply(this, arguments);\n}\n\nexport function addEvents(){\n  this.emit('error', 'This method has been deprecated. Check out #recordEvents: https://github.com/keen/keen-tracking.js#record-multiple-events');\n  recordEvents.apply(this, arguments);\n}\n\n\n// ------------------------------\n// Validation\n// ------------------------------\n\nfunction checkValidation(callback){\n  const cb = callback;\n  callback = null;\n\n  if (!this.projectId()) {\n    handleValidationError.call(this, 'Keen.Client is missing a projectId property.', cb);\n    return false;\n  }\n  if (!this.writeKey()) {\n    handleValidationError.call(this, 'Keen.Client is missing a writeKey property.', cb);\n    return false;\n  }\n  return true;\n}\n\nfunction handleValidationError(message, cb){\n  const err = 'Event(s) not recorded: ' + message;\n  this.emit('error', err);\n  if (cb) {\n    cb.call(this, err, null);\n    cb = null;\n  }\n}\n\nfunction sendEventData(path, eventData, callback){\n  const data = JSON.stringify(eventData);\n\n  let urlPath = this.url('events', path)\n    .replace(this.config.protocol + '://' + this.config.host, '');\n\n  const config = {\n    host: this.config.host,\n    path: urlPath,\n    method: 'POST',\n    headers: {\n      'Authorizationx': this.writeKey(),\n      'Content-Type': 'application/json',\n      'Content-Length': Buffer.byteLength(data)\n    },\n    ...this.config.nodeRequestConfig\n  };\n\n  nodeRequestRetry({\n    retry: this.config.retry,\n    protocol: this.config.protocol,\n    config,\n    data,\n    callbackOnError: callback,\n    callbackOnSuccess: (responseBody) => {\n      let response;\n      let error;\n      try {\n        response = JSON.parse(responseBody);\n      }\n      catch (e) {\n        // Parsing Error\n        error = e;\n      }\n      if (!error && response.error_code) {\n        // API Error\n        error = new Error(response.message || 'Unknown error occurred');\n        error.code = response.error_code;\n      }\n      if (callback) {\n        if (error) {\n          callback(error, null);\n        }\n        if (response) {\n          callback(null, response);\n        }\n      }\n    }\n  });\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__16__;","module.exports = __WEBPACK_EXTERNAL_MODULE__17__;","import KeenCore from './index';\nimport extend from 'keen-core/lib/utils/extend';\nimport {\n  recordEvent,\n  recordEvents,\n  addEvent,\n  addEvents\n} from './record-events-server';\nimport {\n  deferEvent,\n  deferEvents,\n  queueCapacity,\n  queueInterval,\n  recordDeferredEvents\n} from './defer-events';\nimport { extendEvent, extendEvents } from './extend-events';\nimport { getDatetimeIndex } from './helpers/getDatetimeIndex';\nimport { getUniqueId } from './helpers/getUniqueId';\nimport { deepExtend } from './utils/deepExtend';\nimport { timer } from './utils/timer';\nimport pkg from '../package.json';\n\n// ------------------------\n// Methods\n// ------------------------\nextend(KeenCore.prototype, {\n  recordEvent,\n  recordEvents,\n  addEvent,\n  addEvents\n});\nextend(KeenCore.prototype, {\n  deferEvent,\n  deferEvents,\n  queueCapacity,\n  queueInterval,\n  recordDeferredEvents\n});\nextend(KeenCore.prototype, {\n  extendEvent,\n  extendEvents\n});\n\n// ------------------------\n// Helpers\n// ------------------------\nextend(KeenCore.helpers, {\n  getDatetimeIndex,\n  getUniqueId\n});\n\n// ------------------------\n// Utils\n// ------------------------\nextend(KeenCore.utils, {\n  deepExtend,\n  timer\n});\n\nKeenCore.version = pkg.version;\n\nexport const Keen = KeenCore;\nmodule.exports = Keen;\n"],"sourceRoot":""}